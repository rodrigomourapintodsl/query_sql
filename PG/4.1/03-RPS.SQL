SELECT 
    NOTASFISCAIS.CODNOTA,
    NOTASFISCAIS.CODNOTA AS CDNOTA,
    NOTASFISCAIS.CODHOTEL AS CDEMPRESA,
    NOTASFISCAIS.NRONOTA,
    COALESCE(NULLIF(NULLIF(CAST(REGEXP_REPLACE(NOTASFISCAIS.SERIE, '[^0-9]', '', 'G') AS VARCHAR(5)),'0'),''),'1')
    AS SERIE
FROM NOTASFISCAIS
WHERE NOTASFISCAIS.CODHOTEL = :CDEMPRESA
AND NOTASFISCAIS.CODNOTA = :CDNOTA